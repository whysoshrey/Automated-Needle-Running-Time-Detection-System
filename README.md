The Ultrasonic sensor is programmed via any external IDE (We used Arduino IDE) to detect any object (here, the sewing machine pedal) within 15 cm of its range. Leveraging the python code, the duration of the intrusion of the object in front of the ultrasonic sensor is calculated and recorded.
I wrote two different sets of code for this model, one which would be entered in Google Sheets script editor (that supports Javascript) for deploying your particular sheet as a web app and instructing the sheet on how to behave with the in-bound data relay from the NodeMCU controller. We specify the parameter names and the appending method in the JS script and create a pathway for the NodeMCU controller to communicate with the sheet. 
The other code is required to program the NodeMCU controller to interact with the ultrasonic sensor and keeping delay >= 10ms, we take the readings from the ultrasonic sensor and calculate the duration of the intrusion (which would essentially translate to the duration of the sewing pedal being pressed). Using the Deployment ID, the sheet ID and the Script URL provided by Google Sheets, we create a link between the google sheet and the NodeMCU controller.
The code is also used for connecting the NodeMCU to any locally available 2.4 gHz Wi-Fi network, using the ESP8266WiFi.h library, the WiFi SSID and the password.
